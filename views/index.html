<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <title><%= title %></title>
        <link rel="stylesheet" href="/stylesheets/style.css">
    </head>
    <script src="/socket.io/socket.io.js"></script>
    <script src="http://code.jquery.com/jquery-1.7.1.min.js"></script>
    <script src="http://code.highcharts.com/highcharts.js"></script>
    <body>
     <!-- create the div for the chart -->
     <div id="chart" style="width:100%; height:800px;"></div>
     <!-- Start of Javascript -->
    <script>
     // create the websocket; for intranet use the ip-address of the raspberry pi suffices;
    var socket = io.connect('http://localhost:3000');
    var chart;
    chart = new Highcharts.Chart({
        chart: {
            renderTo: 'chart',
            events: {
                load: function() {
                    console.log('loaded')
                    socket.on('initialize', function (values) {
                        console.log(values)
                        chart.series[0].setData(values);
                    });

                    socket.on('update', function(values) {
                        console.log('UPDATE', values)
                        chart.series[0].addPoint(values, 1, 1);
                    });
                }
            }
        },
        title: {
            text: 'Updates (C)'
        },
        xAxis: {
            type: 'datetime',
            tickPixelInterval: 150,
            maxZoom: 20 * 1000
        },
        yAxis: {
            title: {
                text: 'W',
                margin: 80
            }
        },
        plotOptions: {
            series: {
                marker: {
                    radius: 2
                }
            }
        },
        series: [{
            name: 'Usage',
            data: []
        }]
     });
    </script>
 </body>
</html>
